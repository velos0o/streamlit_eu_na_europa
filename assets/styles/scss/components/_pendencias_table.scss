@use '../variables' as *;
@use '../mixins' as *;

// Cores SUTIS para fundo das CÉLULAS de dados por categoria
$cat-andamento-bg-cell: rgba($warning, 0.06);
$cat-sucesso-bg-cell: rgba($success, 0.06);
$cat-falha-bg-cell: rgba($danger, 0.06);
$cat-desconhecido-bg-cell: rgba($gray-500, 0.08);

// Cores para bordas de separação (mantido)
$cat-andamento-border: rgba($warning, 0.3);
$cat-sucesso-border: rgba($success, 0.3);
$cat-falha-border: rgba($danger, 0.3);
$cat-desconhecido-border: rgba($gray-500, 0.3);

.pendencias-table-container {
  margin-top: map-get($spacing, 4);
}

// Aumentar especificidade: target table.dataframe.pendencias-table
table.dataframe.pendencias-table {
  width: 100%;
  border-collapse: collapse; // Remove espaços entre bordas
  font-size: map-get($font-sizes, 'sm'); // Tamanho de fonte menor
  background-color: var(--card-bg, $gray-50); // Fundo geral claro
  box-shadow: map-get($shadows, 'base');
  border-radius: map-get($border-radius, 'md');
  overflow: hidden; // Para que o border-radius funcione nas bordas da tabela
  text-align: center; // Centralizar texto por padrão

  th, td {
    padding: map-get($spacing, 2) map-get($spacing, 2);
    border-bottom: 1px solid var(--card-border, $gray-200);
    vertical-align: middle;
    border-right: 1px solid transparent; // Espaço para borda do header
    white-space: nowrap !important; // <<-- ADICIONAR !important
  }

  // Alinhar primeira coluna (Índice/Responsável)
  thead th:first-child,
  tbody th { // Assumindo que Responsável é sempre <th> no tbody
    text-align: left;
    padding-left: map-get($spacing, 3);
    font-weight: 500;
    background-color: var(--card-bg, $gray-50); // Fundo do tema
    // white-space: nowrap; // Já coberto pela regra geral th, td
    border-right: 1px solid var(--card-border, $gray-300); // Linha divisória após responsável
  }

  // Alinhar última coluna (Total Geral)
  thead th:last-child,
  tbody td:last-child {
    text-align: right;
    font-weight: 600;
    border-left: 1px solid var(--card-border, $gray-300);
    border-right: none;
    padding-right: map-get($spacing, 3);
    background-color: rgba($gray-500, 0.1); // Fundo levemente destacado para total
    // white-space: nowrap; // Já coberto pela regra geral th, td
  }

  thead {
     th {
        background-color: var(--header-bg, $gray-100);
        color: var(--card-text, $gray-700);
        font-weight: 600;
        position: sticky;
        top: 0;
        z-index: 1;
        border-top: none;
        border-bottom: 2px solid var(--card-border, $gray-300);
        border-right: 1px solid transparent; // Espaço para borda da categoria
        white-space: nowrap; // <<-- IMPEDIR QUEBRA DE TEXTO NOS HEADERS
     }
     // Aplicar borda de separação de categoria nos TH da primeira linha
     tr:first-child th {
        // Aplicar a borda direita com base na categoria (pegando do map)
        // Esta borda cria a linha vertical entre categorias
        // Nota: A classe th-cat-* NÃO é mais adicionada pelo Python
        //       Vamos usar a borda para separar visualmente

        // Exemplo (requer lógica para saber qual coluna é qual categoria):
        // &.coluna-sucesso { border-right: 1px solid $cat-sucesso-border !important; }
        // &.coluna-falha { border-right: 1px solid $cat-falha-border !important; }
        // ... etc ...
        // --> A borda será controlada pelo CSS injetado pelo Python agora
     }
     // Garantir que a segunda linha do header (se existir) tenha estilo padrão
     tr:not(:first-child) th {
         background-color: var(--header-bg, $gray-100) !important;
         border-right: none !important;
         font-weight: normal; // Estilo menos destacado
     }
  }

  tbody tr:last-child { // Linha de Total Geral
    background-color: transparent; // Remover fundo da linha toda
    font-weight: bold;
    border-top: 2px solid var(--card-border, $gray-300);

    th, td { // Aplicar a todas as células da linha total
      color: var(--card-text, $gray-700);
      background-color: var(--header-bg, $gray-100); // Fundo consistente para linha total
    }
    td:last-child {
        font-weight: 700;
        background-color: rgba($gray-500, 0.15); // Fundo mais destacado para célula total
    }
  }
}

// Ajustes para tema escuro
@include dark-mode {
  table.dataframe.pendencias-table {
    background-color: var(--card-bg, $gray-800);
    border-color: $gray-700;

    th, td { border-bottom-color: var(--card-border, $gray-700); }
    thead th:first-child, tbody th { border-right-color: var(--card-border, $gray-600); }
    thead th:last-child, tbody td:last-child { border-left-color: var(--card-border, $gray-600); background-color: rgba($gray-100, 0.1);}
    tbody th { background-color: var(--card-bg, $gray-800); }
    thead th, thead tr:not(:first-child) th, tbody tr:last-child th, tbody tr:last-child td {
        background-color: var(--header-bg, $gray-900) !important;
    }
    thead th { border-bottom-color: var(--card-border, $gray-600); }
    tbody tr:last-child { border-top-color: var(--card-border, $gray-600); }
    tbody tr:last-child td:last-child { background-color: rgba($gray-100, 0.15); }

    // Cores SUTIS para fundo das CÉLULAS (Dark Mode)
    // Estas variáveis NÃO são usadas diretamente aqui, mas servem de referência para o Python
    $cat-andamento-bg-cell-dark: rgba($warning, 0.12);
    $cat-sucesso-bg-cell-dark: rgba($success, 0.12);
    $cat-falha-bg-cell-dark: rgba($danger, 0.12);
    $cat-desconhecido-bg-cell-dark: rgba($gray-500, 0.15);
  }
} 
} 